install.packages("BMA")
install.packages("compare")
require(nFactors)
install.packages("nFactors")
install.packages("xtable")
require(Matching)
install.packages("Amelia")
setwd("~/Dropbox/gh_projects/misarchism")
source("~/Dropbox/code/multiplot.R")
setwd("~/Downloads")
setwd("~/Downloads/replication")
require(foreign)
df<-read.dta("ViolentFlank.dta")
View(df)
write.csv(df)
write.csv(df, file="Chenoweth_Schock_2015.csv")
knitr::opts_chunk$set(echo=FALSE, message=FALSE, fig.path='figures/')
options(digits=3)
require(Zelig)
setwd("~/Dropbox/gh_projects/misarchism")
source("analyses/factor_analysis.R")
source("analyses/main_regressions.R")
install.packages("Zelig", repos = "http://r.iq.harvard.edu/archived/", type = "source")
knitr::opts_chunk$set(echo=FALSE, message=FALSE, fig.path='figures/')
options(digits=3)
require(Zelig)
factor.plot
summary(fad)
print(fad, sort=TRUE)
fad
summary(fit)
print(fit, sort=TRUE)
fit
fit <- fa(factor.vars[15:length(factor.vars)], nfactors=2,
rotate = "oblimin", fm = "ml", warnings=FALSE,
missing=FALSE)
View(load)
setwd("~/Dropbox/gh_projects/misarchism")
require(arm)
require(ggplot2)
require(GPArotation)
df<-read.csv("data/misarchism_data.csv")
########### Run this analysis first
factor.vars<-subset(df)
factor.vars<-factor.vars[c("caseid", "tea_supp", "gender_respondent_x", "fox", "bornagain", "church",
"white", "Auth", "dem_edu", "dem_age_r_x", "Obama",
"republican",
"inc_incgroup_pre", "libcpre_self",
"trad_famval", "gun_control",
"trad_tolerant", "trad_adjust", "wiretap",
"defsppr_self", "spsrvpr_ssself",
"immig_checks", "guarpr_self")]
# Rescale numeric variables (First 7 columns are categorical variables)
factor.vars[8:length(factor.vars)]<-as.data.frame(sapply(factor.vars[8:length(factor.vars)], function(x) rescale(x)))
detach("package:arm", unload=TRUE)
require(psych)
set.seed(666)
#######################################
## Scree plot for early exploration ###
#######################################
# fad<-factor.vars[10:length(factor.vars)]
#
# ev <- eigen(cor(fad)) # get eigenvalues
# ap <- parallel(subject=nrow(fad),var=ncol(fad),
#                rep=100,cent=.05)
# nS <- nScree(x=ev$values, aparallel=ap$eigen$qevpea)
# scree.plot<-plotnScree(nS)
########################################
### Factor analysis in paper ###########
########################################
# "15:length" excludes party id, "14:length" includes it
fit <- fa(factor.vars[15:length(factor.vars)], nfactors=2,
rotate = "oblimin", fm = "ml", warnings=FALSE,
missing=FALSE)
fad<-factor.vars[15:length(factor.vars)] # "factor analysis data" for later checks
# summary(fit)
# print(fit, sort=TRUE)
# fit
############################################
### Including ideological self-placement ###
############################################
fit2 <- fa(factor.vars[14:length(factor.vars)], nfactors=2,
rotate = "oblimin", fm = "ml", warnings=FALSE,
missing=FALSE)
fad2<-factor.vars[14:length(factor.vars)] # "factor analysis data" for later checks
detach("package:psych", unload=TRUE)
require(arm)
factor.vars$Government2 <- rescale(fit2$scores[,1])
factor.vars$MoralStatism2 <- rescale(fit2$scores[,2])
###############################################
load <- as.data.frame(fit$loadings[,1:2])
set.seed(123)
rownames(load)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense",
"Services", "Immigration", "Jobs")
factor.plot<-ggplot(load, aes(x=ML2, y=ML1, label=rownames(load))) +
geom_text(size=4, position = position_jitter(w = 0.03, h = 0.03)) +
theme_bw() +
labs(x="Factor 2 (Moral Statism)", y="Factor 1 (Governmentalism)")
factor.vars$Government <- rescale(fit$scores[,1])
factor.vars$MoralStatism <- rescale(fit$scores[,2])
factor.vars$Antigov<-max(factor.vars$Government, na.rm=T)-factor.vars$Government
factor.vars$Mis<-factor.vars$MoralStatism*factor.vars$Antigov
factor.vars$republican.cat<-ordered(as.factor(df$republican))
factor.vars$ideology.cat<-ordered(as.factor(df$libcpre_self))
factor.vars$Mis.cat<-ordered(cut(factor.vars$Mis, breaks=3))
factor.vars$Antigov.cat<-ordered(cut(factor.vars$Antigov, breaks=3))
factor.vars$MoralStatism.cat<-ordered(cut(factor.vars$MoralStatism, breaks=3))
detach("package:arm", unload=TRUE)
# Keep version with missing for imputation in 'missing.R'
factor.vars.miss<-factor.vars
# Keep version for comparisons to conservatism and republicanism
explore.subset<-subset(factor.vars, select=c("libcpre_self", "ideology.cat", "republican",
"republican.cat", "tea_supp", "Government", "Antigov", "Antigov.cat",
"Mis", "Mis.cat", "MoralStatism", "MoralStatism.cat"))
explore.subset<-explore.subset[complete.cases(explore.subset),]
# Remove missing for main regression models
factor.vars<-factor.vars[complete.cases(factor.vars),]
summary(fit)
print(fit, sort=TRUE)
setwd("~/Dropbox/gh_projects/misarchism")
require(arm)
require(ggplot2)
require(GPArotation)
df<-read.csv("data/misarchism_data.csv")
########### Run this analysis first
factor.vars<-subset(df)
factor.vars<-factor.vars[c("caseid", "tea_supp", "gender_respondent_x", "fox", "bornagain", "church",
"white", "Auth", "dem_edu", "dem_age_r_x", "Obama",
"republican",
"inc_incgroup_pre", "libcpre_self",
"trad_famval", "gun_control",
"trad_tolerant", "trad_adjust", "wiretap",
"defsppr_self", "spsrvpr_ssself",
"immig_checks", "guarpr_self")]
# Rescale numeric variables (First 7 columns are categorical variables)
factor.vars[8:length(factor.vars)]<-as.data.frame(sapply(factor.vars[8:length(factor.vars)], function(x) rescale(x)))
detach("package:arm", unload=TRUE)
require(psych)
set.seed(666)
#######################################
## Scree plot for early exploration ###
#######################################
# fad<-factor.vars[10:length(factor.vars)]
#
# ev <- eigen(cor(fad)) # get eigenvalues
# ap <- parallel(subject=nrow(fad),var=ncol(fad),
#                rep=100,cent=.05)
# nS <- nScree(x=ev$values, aparallel=ap$eigen$qevpea)
# scree.plot<-plotnScree(nS)
########################################
### Factor analysis in paper ###########
########################################
# "15:length" excludes party id, "14:length" includes it
fit <- fa(factor.vars[15:length(factor.vars)], nfactors=2,
rotate = "oblimin", fm = "ml", warnings=FALSE,
missing=FALSE)
summary(fit)
print(fit, sort=TRUE)
require(corrplot)
M<-cor(factor.vars[c("trad_famval", "gun_control", "trad_tolerant", "trad_adjust", "wiretap", "defsppr_self",
"spsrvpr_ssself", "immig_checks", "guarpr_self")], use="complete.obs")
corrplot(M, method = "number", type = "upper", diag=T,
mar=c(0,0,0,3),
tl.srt=20,
tl.offset=1,
tl.col="black",
tl.cex=.8,
order = "hclust", addrect = 2,
)
M<-cor(factor.vars[c("trad_famval", "gun_control", "trad_tolerant", "trad_adjust", "wiretap", "defsppr_self",
"spsrvpr_ssself", "immig_checks", "guarpr_self")], use="complete.obs")
rownames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration",
"Jobs")
colnames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration",
"Jobs")
corrplot(M, method = "number", type = "upper", diag=T,
mar=c(0,0,0,3),
tl.srt=20,
tl.offset=1,
tl.col="black",
tl.cex=.8,
order = "hclust", addrect = 2,
)
rownames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration (Checks)",
"Jobs")
colnames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration (Checks)",
"Jobs")
corrplot(M, method = "number", type = "upper", diag=T,
mar=c(0,0,0,3),
tl.srt=20,
tl.offset=1,
tl.col="black",
tl.cex=.8,
order = "hclust", addrect = 2,
)
M<-cor(factor.vars[c("trad_famval", "gun_control", "trad_tolerant", "trad_adjust", "wiretap", "defsppr_self",
"spsrvpr_ssself", "immig_checks", "guarpr_self")], use="complete.obs")
rownames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration",
"Jobs")
colnames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services",
"Jobs")
corrplot(M, method = "number", type = "upper", diag=T,
mar=c(0,0,0,3),
tl.srt=20,
tl.offset=1,
tl.col="black",
tl.cex=.8,
order = "hclust", addrect = 2,
)
rownames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration",
"Jobs")
colnames(M)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense", "Services", "Immigration",
"Jobs")
corrplot(M, method = "number", type = "upper", diag=T,
mar=c(0,0,0,3),
tl.srt=20,
tl.offset=1,
tl.col="black",
tl.cex=.8,
order = "hclust", addrect = 2,
)
require(stargazer)
stargazer(model1, model2, model2.cons, header=FALSE, font.size="footnotesize", no.space=TRUE, title="Logistic Regressions, Tea Party Support",
covariate.labels = c("Gender (Male)", "Income", "Age", "Race (White)",
"Education", "Obama", "Authoritarianism", "BornAgain", "Religion",
"PartyID (Republican)", "FoxNews","Conservatism", "MoralStatism", "Government",
"MoralStatism*Government"),
dep.var.labels.include=FALSE,
dep.var.caption="")
require(visreg)
source("~/Dropbox/code/multiplot.R")
visreg(model2, "MoralStatism", by="Gov", overlay=T, scale="response", breaks=c(-.7,0,.6),
line=list(lty=c(1,2,3)))
?visreg
visreg(model2.cons, "MoralStatism", by="Gov", overlay=T, scale="response", breaks=c(-.9,-.4,.3),
line=list(lty=c(1,2,3)))
