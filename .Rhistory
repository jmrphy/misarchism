detach(factor.vars)
ps  <- glm(MSG ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$G)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$MSG
Y <- matdf$tea_supp
set.seed(666)
load("data/genout_MSG.RData")
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=F, Weight.matrix=genout3, exact=T)
summary(match_msg)
setwd("~/Dropbox/gh_projects/misarchism")
require(arm)
require(ggplot2)
require(GPArotation)
df<-read.csv("data/misarchism_data.csv")
########### Run this analysis first
factor.vars<-subset(df)
factor.vars<-factor.vars[c("caseid", "tea_supp", "gender_respondent_x", "fox", "bornagain", "church",
"white", "Auth", "dem_edu", "dem_age_r_x", "Obama",
"republican",
"inc_incgroup_pre", "libcpre_self",
"trad_famval", "gun_control",
"trad_tolerant", "trad_adjust", "wiretap",
"defsppr_self", "spsrvpr_ssself",
"immig_checks", "guarpr_self")]
# Rescale numeric variables (First 7 columns are categorical variables)
factor.vars[8:length(factor.vars)]<-as.data.frame(sapply(factor.vars[8:length(factor.vars)], function(x) rescale(x)))
detach("package:arm", unload=TRUE)
require(psych)
set.seed(666)
#######################################
## Scree plot for early exploration ###
#######################################
# fad<-factor.vars[10:length(factor.vars)]
#
# ev <- eigen(cor(fad)) # get eigenvalues
# ap <- parallel(subject=nrow(fad),var=ncol(fad),
#                rep=100,cent=.05)
# nS <- nScree(x=ev$values, aparallel=ap$eigen$qevpea)
# scree.plot<-plotnScree(nS)
########################################
### Factor analysis in paper ###########
########################################
# "15:length" excludes traditional ideology (conservatism), "14:length" includes it
fit <- fa(factor.vars[15:length(factor.vars)], nfactors=2,
rotate = "oblimin", fm = "ml", warnings=FALSE,
missing=FALSE)
fad<-factor.vars[15:length(factor.vars)] # "factor analysis data" for later checks
# summary(fit)
# print(fit, sort=TRUE)
# fit
############################################
### Including ideological self-placement ###
############################################
fit2 <- fa(factor.vars[14:length(factor.vars)], nfactors=2,
rotate = "oblimin", fm = "ml", warnings=FALSE,
missing=FALSE)
fad2<-factor.vars[14:length(factor.vars)] # "factor analysis data" for later checks
detach("package:psych", unload=TRUE)
require(arm)
# 'fa' function spits out the factors in opposite order this time
# See this in load2
factor.vars$Government2 <- rescale(fit2$scores[,2])
factor.vars$MoralStatism2 <- rescale(fit2$scores[,1])
load2 <- as.data.frame(fit2$loadings[,1:2])
###############################################
### Factor plot in main text
###############################################
load <- as.data.frame(fit$loadings[,1:2])
set.seed(123)
rownames(load)<-c("Family", "Guns", "Intolerant", "Morals", "Wiretapping", "Defense",
"Services", "Immigration", "Jobs")
factor.plot<-ggplot(load, aes(x=ML2, y=ML1, label=rownames(load))) +
geom_text(size=4, position = position_jitter(w = 0.03, h = 0.03)) +
theme_bw() +
labs(x="Factor 2 (Moral Statism)", y="Factor 1 (Governmentalism)")
factor.vars$Government <- rescale(fit$scores[,1])
factor.vars$MoralStatism <- rescale(fit$scores[,2])
factor.vars$Antigov<-max(factor.vars$Government, na.rm=T)-factor.vars$Government
factor.vars$Mis<-factor.vars$MoralStatism*factor.vars$Antigov
factor.vars$republican.cat<-ordered(as.factor(df$republican))
factor.vars$ideology.cat<-ordered(as.factor(df$libcpre_self))
factor.vars$Mis.cat<-ordered(cut(factor.vars$Mis, breaks=3))
factor.vars$Antigov.cat<-ordered(cut(factor.vars$Antigov, breaks=3))
factor.vars$MoralStatism.cat<-ordered(cut(factor.vars$MoralStatism, breaks=3))
detach("package:arm", unload=TRUE)
# Keep version with missing for imputation in 'missing.R'
factor.vars.miss<-factor.vars
# Keep version for comparisons to conservatism and republicanism
explore.subset<-subset(factor.vars, select=c("libcpre_self", "ideology.cat", "republican",
"republican.cat", "tea_supp", "Government", "Antigov", "Antigov.cat",
"Mis", "Mis.cat", "MoralStatism", "MoralStatism.cat"))
explore.subset<-explore.subset[complete.cases(explore.subset),]
# Remove missing for main regression models
factor.vars<-factor.vars[complete.cases(factor.vars),]
#require(Zelig)
require(car)
factor.vars$bornagain<-relevel(factor.vars$bornagain, ref="2. no")
factor.vars$church<-relevel(factor.vars$church, ref="2. no")
factor.vars$gender_respondent_x<-relevel(factor.vars$gender_respondent_x, ref="2. female")
factor.vars$Support<-factor.vars$tea_supp
model1<-glm(Support ~ gender_respondent_x + inc_incgroup_pre +
dem_age_r_x + white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + libcpre_self,
family=binomial,
data=factor.vars)
#  summary(model1)
# model1classif<-table(model1$fitted.values>.5, model1$y)
# model1correct<-(model1classif[1,1] + model1classif[2,2])
# (model1correct/nrow(factor.vars))*100
# misarchism.vars<-subset(df, select=c("tea_supp", "gender_respondent_x", "libcpre_self", "dem_age_r_x", "white", "dem_edu",
#                                      "trad_adjust", "trad_lifestyle", "defsppr_self", "spsrvpr_ssself","aidblack_self",
#                                       "immig_checks", "wiretap"))
# misarchism.vars<-misarchism.vars[complete.cases(misarchism.vars),]
factor.vars$Gov<-factor.vars$Government
model2<-glm(Support ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + libcpre_self + MoralStatism + Gov + MoralStatism:Gov,
family=binomial,
data=factor.vars)
model2.cons<-glm(Support ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + libcpre_self + MoralStatism + Gov + MoralStatism:Gov,
family=binomial,
data=subset(factor.vars, libcpre_self>mean(libcpre_self)))
# summary(model2)
# require(car)
# vif(model2)
# model2classif<-table(model2$fitted.values>.5, model2$y)
# model2correct<-(model2classif[1,1] + model2classif[2,2])
#  (model2correct/nrow(factor.vars))*100
model2.z<-zelig(Support ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + libcpre_self + MoralStatism + Gov + MoralStatism:Gov,
model="logit",
data=factor.vars,
cite=F)
#
# summary(model2.z)
set.seed(666)
# Moral Statism
ms.low<-setx(model2.z, MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.out.low <- sim(model2.z, x = ms.low)
ms.hi<-setx(model2.z, MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.out.hi <- sim(model2.z, x = ms.hi)
#
ms.out <- sim(model2.z, x = ms.low, x1 = ms.hi)
# summary(ms.out)
# Governmentalism
g.low<-setx(model2.z, Gov=quantile(factor.vars$Gov, .1))
g.out.low <- sim(model2.z, x = g.low)
g.hi<-setx(model2.z, Gov=quantile(factor.vars$Gov, .9))
g.out.hi <- sim(model2.z, x = g.hi)
#
g.out <- sim(model2.z, x = g.hi, x1 = g.low)
# summary(g.out)
# Obama
o.low<-setx(model2.z, Obama=quantile(factor.vars$Obama, .1))
o.out.low <- sim(model2.z, x = o.low)
o.hi<-setx(model2.z, Obama=quantile(factor.vars$Obama, .9))
o.out.hi <- sim(model2.z, x = o.hi)
#
o.out <- sim(model2.z, x = o.hi, x1 = o.low)
# summary(o.out)
# Auth
a.low<-setx(model2.z, Auth=0)
a.hi<-setx(model2.z, Auth=1)
#
a.out <- sim(model2.z, x = a.low, x1 = a.hi)
# summary(a.out)
# MS * G Plot
msg.low<-setx(model2.z, MoralStatism=seq(min(factor.vars$MoralStatism),max(factor.vars$MoralStatism), by=.075),
Gov=quantile(factor.vars$Gov, .9))
msg.hi<-setx(model2.z, MoralStatism=seq(min(factor.vars$MoralStatism),max(factor.vars$MoralStatism), by=.075),
Gov=quantile(factor.vars$Gov, .1))
#
msg.out <- sim(model2.z, x = msg.low, x1 = msg.hi)
# # plot(msg.out)
# # summary(msg.out)
# MS*G Effect calculation
# MS shift when people like government
ms.low.g.hi<-setx(model2.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.hi.out <- sim(model2.z, x = ms.low.g.hi)
ms.hi.g.hi<-setx(model2.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.hi.out <- sim(model2.z, x = ms.hi.g.hi)
msgout1 <- sim(model2.z, x = ms.low.g.hi, x1 = ms.hi.g.hi)
# MS shift when people don't like government
ms.low.g.low<-setx(model2.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.low.out <- sim(model2.z, x = ms.low.g.low)
ms.hi.g.low<-setx(model2.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.low.out <- sim(model2.z, x = ms.hi.g.low)
msgout2 <- sim(model2.z, x = ms.low.g.low, x1 = ms.hi.g.low)
# Most likely model according to BMA?
model2.z.reduced<-zelig(tea_supp ~ Obama + fox +inc_incgroup_pre + dem_age_r_x +
white + libcpre_self + MoralStatism + Government + MoralStatism:Government,
model="logit",
data=factor.vars,
cite=F)
msg.low<-setx(model2.z.reduced, MoralStatism=seq(min(factor.vars$MoralStatism),max(factor.vars$MoralStatism), by=.075),
Government=quantile(factor.vars$Government, .9))
msg.hi<-setx(model2.z.reduced, MoralStatism=seq(min(factor.vars$MoralStatism),max(factor.vars$MoralStatism), by=.075),
Government=quantile(factor.vars$Government, .1))
#
msg.out.reduced <- sim(model2.z.reduced, x = msg.low, x1 = msg.hi)
# # plot(msg.out.reduced)
# # summary(msg.out.reduced)
factor.vars$trad_avg<-(factor.vars$trad_famval+factor.vars$trad_adjust+factor.vars$trad_tolerant)/3
model.allvars<-glm(tea_supp ~ gender_respondent_x + inc_incgroup_pre +
dem_age_r_x + white + dem_edu + Obama + Auth + bornagain +
church + republican + fox +libcpre_self +
trad_famval + trad_adjust + trad_tolerant + guarpr_self + defsppr_self + spsrvpr_ssself + gun_control +
immig_checks + wiretap,
family="binomial",
data=factor.vars)
#
# summary(model.allvars)
# vif(model.allvars)
model.republican<-lm(republican ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + fox + libcpre_self + MoralStatism + Government + MoralStatism:Government,
data=factor.vars)
summary(model.republican)
model.conservative<-lm(libcpre_self ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + MoralStatism + Government + MoralStatism:Government,
data=factor.vars)
summary(model.conservative)
####################################
## With ideology in factor model ###
####################################
model2.noideology<-glm(tea_supp ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox  + MoralStatism2 + Government2 + MoralStatism2:Government,
family=binomial,
data=factor.vars)
### BMA
require(BMA)
require(compare)
require(foreign)
require(Matching)
require(ggplot2)
setwd("~/Dropbox/gh_projects/misarchism")
source("functions/Altered_BMA_Functions.R")
# Define data matrices
factor.vars$MoralStatismXGovernment<-factor.vars$MoralStatism*factor.vars$Government
attach(factor.vars)
bma.vars<- as.data.frame(cbind(tea_supp, gender_respondent_x, inc_incgroup_pre, dem_age_r_x, white, dem_edu, Obama,
Auth, bornagain, church, republican, fox, libcpre_self, MoralStatism, Government, MoralStatismXGovernment))
detach(factor.vars)
y <- bma.vars$tea_supp
bma.vars$tea_supp <- NULL
set.seed(666)
bm <- bic.glmMN(bma.vars, y, glm.family="binomial", strict=FALSE, factor.type=TRUE, occam.window=FALSE,
all.none.list=list(c(13,14,15)), OR.fix=200, nbest=100000)
# summary(bm)
bmastats<-as.data.frame(bm$probne0)
bmastats$Variables<-bm$namesx
names(bmastats)<-c("Probability", "Variables")
bmastats$Variables<-as.factor(bmastats$Variables)
bmastats$Variables<-c("Gender (Male)", "Income", "Age", "Race (White)",
"Education", "Obama", "Authoritarianism", "BornAgain", "Religion",
"PartyID (Republican)", "FoxNews", "Conservative", "MoralStatism", "Government",
"MoralStatism*Government")
bmastats$Variables<-reorder(bmastats$Variables, bmastats$Probability)
bma.plot<-ggplot(bmastats, aes(x=Variables, y=Probability)) +
geom_bar(stat="identity") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(y="Probability of Inclusion")
bmastats$EV<-bm$postmean[2:16]
bmastats$SD<-bm$postsd[2:16]
limits <- aes(ymax = bmastats$EV + bmastats$SD, ymin=bmastats$EV - bmastats$SD)
bma.plot2<-ggplot(bmastats, aes(x=Variables)) +
geom_bar(aes(y=EV), stat="identity") +
geom_errorbar(limits, width=0.25, colour="grey") +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(y="Expected Values")
# imageplot.bma(bm, order="probne0")
load("data/genout_G.RData")
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=F)
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(G ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$MSG)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$G
Y <- matdf$tea_supp
set.seed(666)
#
factor.vars$MS<-ifelse(factor.vars$MoralStatism>mean(factor.vars$MoralStatism), TRUE, FALSE)
factor.vars$G<-ifelse(factor.vars$Government>mean(factor.vars$Government), TRUE, FALSE)
factor.vars$MSG<-ifelse(factor.vars$MoralStatismXGovernment>mean(factor.vars$MoralStatismXGovernment), TRUE, FALSE)
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(G ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$MSG)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$G
Y <- matdf$tea_supp
set.seed(666)
load("data/genout_G.RData")
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=F)
summary(match_g)
plot(genout2)
?Match
mb_g  <- MatchBalance(G ~ Obama + bornagain + fox + libcpre_self,
data=matdf, match.out=match_g, nboots=500, print.level=2)
match_g$est
plot(genout2)
plot(mb_g)
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=T)
summary(match_g)
mb_g  <- MatchBalance(G ~ Obama + bornagain + fox + libcpre_self,
data=matdf, match.out=match_g, nboots=500, print.level=2)
match_g$est
plot(mb_g)
summary(match_g)
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=F)
summary(match_g)
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(MSG ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$G)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$MSG
Y <- matdf$tea_supp
set.seed(999)
summary(match_g)
load("data/genout_MSG.RData")
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout3)
summary(match_msg)
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout3, exact=T)
summary(match_msg)
summary(match_msg)
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(G ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$MSG)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$G
Y <- matdf$tea_supp
set.seed(666)
genout2 <- GenMatch(Tr=treatment, X=X, BalanceMatrix=bal.mat, estimand="ATT",
M=1, pop.size=1000, max.generations=100, wait.generations=2)
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=T)
summary(match_g)
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=F)
summary(match_g)
save(genout2, file="data/genout_G.RData")
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(MSG ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$G)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$MSG
Y <- matdf$tea_supp
set.seed(999)
genout3 <- GenMatch(Tr=treatment, X=X, BalanceMatrix=bal.mat, estimand="ATT",
M=1, pop.size=1000, max.generations=100, wait.generations=2)
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout3, exact=T)
summary(match_msg)
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout3, exact=F)
summary(match_msg)
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout3, exact=T)
summary(match_msg)
binarysens(match_msg, Gamma = 3, GammaInc = 0.01)
mb_msg  <- MatchBalance(MSG ~ white + Obama + bornagain + fox + libcpre_self,
data=matdf, match.out=match_msg, nboots=500, print.level=2)
binarysens(match_msg, Gamma = 3, GammaInc = 0.01)
binarysens(match_g, Gamma = 3, GammaInc = 0.01)
save(genout3, file="data/genout_MSG.RData")
model2.cons.z<-zelig(Support ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + libcpre_self + MoralStatism + Gov + MoralStatism:Gov,
model="logit",
data=subset(factor.vars, libcpre_self>mean(libcpre_self)),
cite=F)
summary(model2.cons.z)
ms.low.g.hi<-setx(model2.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.hi.out <- sim(model2.z, x = ms.low.g.hi)
ms.hi.g.hi<-setx(model2.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.hi.out <- sim(model2.z, x = ms.hi.g.hi)
msgout1 <- sim(model2.z, x = ms.low.g.hi, x1 = ms.hi.g.hi)
# MS shift when people don't like government
ms.low.g.low<-setx(model2.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.low.out <- sim(model2.z, x = ms.low.g.low)
ms.hi.g.low<-setx(model2.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.low.out <- sim(model2.z, x = ms.hi.g.low)
msgout2 <- sim(model2.z, x = ms.low.g.low, x1 = ms.hi.g.low)
round(mean(msgout1$qi$fd),3)*100
round(sd(msgout1$qi$fd),3)*100
round(mean(msgout2$qi$fd),3)*100
round(sd(msgout2$qi$fd),3)*100
round(mean(ms.low.g.low.out$qi$ev),3)
round(mean(ms.hi.g.low.out$qi$ev),3)
round(mean(msgout1.cons$qi$fd),3)*100
# MS shift when people like government
ms.low.g.hi.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.hi.out.cons <- sim(model2.cons.z, x = ms.low.g.hi.cons)
ms.hi.g.hi.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.hi.out.cons <- sim(model2.cons.z, x = ms.hi.g.hi.cons)
msgout1.cons <- sim(model2.cons.z.cons, x = ms.low.g.hi.cons, x1 = ms.hi.g.hi.cons)
model2.cons.z<-zelig(Support ~ gender_respondent_x + inc_incgroup_pre + dem_age_r_x +
white + dem_edu + Obama + Auth + bornagain +
church + republican + fox + libcpre_self + MoralStatism + Gov + MoralStatism:Gov,
model="logit",
data=subset(factor.vars, libcpre_self>mean(libcpre_self)),
cite=F)
ms.low.g.hi.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.hi.out.cons <- sim(model2.cons.z, x = ms.low.g.hi.cons)
ms.hi.g.hi.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .9), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.hi.out.cons <- sim(model2.cons.z, x = ms.hi.g.hi.cons)
msgout1.cons <- sim(model2.cons.z.cons, x = ms.low.g.hi.cons, x1 = ms.hi.g.hi.cons)
# MS shift when people don't like government
ms.low.g.low.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.low.out.cons <- sim(model2.cons.z, x = ms.low.g.low.cons)
ms.hi.g.low.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.low.out.cons <- sim(model2.cons.z, x = ms.hi.g.low.cons)
msgout2.cons <- sim(model2.cons.z, x = ms.low.g.low.cons, x1 = ms.hi.g.low.cons)
msgout1.cons <- sim(model2.cons.z, x = ms.low.g.hi.cons, x1 = ms.hi.g.hi.cons)
ms.low.g.low.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .1))
ms.low.g.low.out.cons <- sim(model2.cons.z, x = ms.low.g.low.cons)
ms.hi.g.low.cons<-setx(model2.cons.z, Gov=quantile(factor.vars$Gov, .1), MoralStatism=quantile(factor.vars$MoralStatism, .9))
ms.hi.g.low.out.cons <- sim(model2.cons.z, x = ms.hi.g.low.cons)
msgout2.cons <- sim(model2.cons.z, x = ms.low.g.low.cons, x1 = ms.hi.g.low.cons)
# Most likely model according to BMA?
model2.z.reduced<-zelig(tea_supp ~ Obama + fox +inc_incgroup_pre + dem_age_r_x +
white + libcpre_self + MoralStatism + Government + MoralStatism:Government,
model="logit",
data=factor.vars,
cite=F)
round(mean(msgout1.cons$qi$fd),3)*100
round(sd(msgout1.cons$qi$fd),3)*100
round(mean(msgout2$qi$fd),3)*100
round(sd(msgout2.cons$qi$fd),3)*100
round(mean(ms.low.g.low.out.cons$qi$ev),3)
round(mean(ms.hi.g.low.out.cons$qi$ev),3)
round(mean(msgout1.cons$qi$fd),3)*100
round(sd(msgout1.cons$qi$fd),3)*100
round(mean(ms.low.g.hi.out.cons$qi$ev),3)
round(mean(ms.hi.g.hi.out.cons$qi$ev),3)
binarysens(match_msg, Gamma = 3, GammaInc = 0.01)
match_msg$se
match_msg$est
binarysens(match_g, Gamma = 3, GammaInc = 0.01)
summary(match_g)
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=T)
summary(match_g)
binarysens(match_g, Gamma = 3, GammaInc = 0.01)
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(G ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$MSG)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$G
Y <- matdf$tea_supp
set.seed(666)
match_g <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout2, exact=T)
summary(match_g)
binarysens(match_g, Gamma = 3, GammaInc = 0.01)
summary(match_g)
match_g$se
attach(factor.vars)
matdf<- as.data.frame(cbind(tea_supp, dem_edu, Obama, bornagain,
libcpre_self, fox, MS, G, MSG))
detach(factor.vars)
ps  <- glm(MSG ~ Obama + bornagain + fox + libcpre_self,
family = binomial, data = matdf)
X <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self, matdf$MS, matdf$G)
bal.mat <- cbind(ps$fitted, matdf$Obama, matdf$bornagain, matdf$fox, matdf$libcpre_self)
treatment <- matdf$MSG
Y <- matdf$tea_supp
set.seed(999)
match_msg <- Match(Y=Y, Tr=treatment, X=X, estimand="ATT",
M=1, BiasAdjust=FALSE, Weight.matrix=genout3, exact=T)
summary(match_msg)
binarysens(match_msg, Gamma = 3, GammaInc = 0.01)
summary(match_msg)
